<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Bigfoot Sightings </title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    "This is just filler text"
    <select id="selDataset" onchange="optionChanged(this.value)"></select>
    <div id="pie"></div>
    <script>
            var url = "/names"
            Plotly.d3.json(url,function(error,response){
                if(error) console.log(error)
                var dropdown = document.getElementById("selDataset");
    
                for(var i = 0; i< response.length;i++){
                    var elements = document.createElement("option");
                    var arr = response[i];
                    elements.textContent = arr;
                    elements.value = arr;
                    dropdown.appendChild(elements);
            };
            
                // var trace = {
                //     labels:top10 otu_ids,
                //     values:top_10vals
                // }
            // var data = [response]
        });
    
        // function updatePlotly(newdata) {
        //         var pie = document.getElementById('pie');
        //         Plotly.restyle(pie, 'x', [newdata.x])
        //         Plotly.restyle(pie, 'y', [newdata.y])
        //     }
        function updatePlotly(newdata) {
            var PIE = document.getElementById("pie");
            Plotly.restyle(PIE, "values", [newdata]);
            }

        function optionChanged(route) {
                console.log(route);
                Plotly.d3.json('/samples'+`/${route}`,function(error,response){
                    console.log(response);
                    var trace = {
                    labels : response.otu_ids,
                    values : response.sample_values,
                    type : 'pie'
                    };
                    var data = [trace];
                    var PIE = document.getElementById("pie");
                    Plotly.plot('pie',data)
                    var update = {
                        labels : response.otu_ids,
                        values : response.sample_values,
                        type : 'pie'
                    };
                    Plotly.restyle(PIE,update)
            });
        // function getData(route){
        //     Plotly.d3.json('/samples'+`/${route}`,function(error,response){
        //         var data = response.otu_ids
        //         data = 

        // }
            
            // window.location.replace('samples'+`/${route}`);
        }
    </script>
    
    
</body>
</html>